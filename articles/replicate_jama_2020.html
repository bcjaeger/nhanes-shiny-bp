<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cardioStatsUSA">
<title>Replicating analysis from Muntner et al, 2020 • cardioStatsUSA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Replicating analysis from Muntner et al, 2020">
<meta property="og:description" content="cardioStatsUSA">
<meta property="og:image" content="https://jhs-hwg.github.io/cardioStatsUSA/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cardioStatsUSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cardioStatsUSA.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-results">Results</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-results">
    <a class="dropdown-item" href="../articles/bp_control.html">Blood pressure control</a>
    <a class="dropdown-item" href="../articles/hypertension.html">Hypertension</a>
    <a class="dropdown-item" href="../articles/bp_meds.html">Antihypertensive medication use</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-validation">Validation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-validation">
    <a class="dropdown-item" href="../articles/replicate_jama_2020.html">Muntner et al, 2020</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Replicating analysis from Muntner et al, 2020</h1>
            
      
      
      <div class="d-none name"><code>replicate_jama_2020.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="who-is-included-in-this-test">Who is included in this test<a class="anchor" aria-label="anchor" href="#who-is-included-in-this-test"></a>
</h2>
<p>For these tests, we include the same cohort as Muntner et al. Full details on the inclusion criteria are given in the paper, but here all that we need to do is subset the data to include rows where <code>svy_subpop_htn</code> is equal to 1.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhanes_subpop_htn</span> <span class="op">&lt;-</span> <span class="va">nhanes_data</span><span class="op">[</span><span class="va">svy_subpop_htn</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>after these exclusions, <code>56035</code> participants are included.</p>
</div>
<div class="section level2">
<h2 id="age-adjustment">Age adjustment<a class="anchor" aria-label="anchor" href="#age-adjustment"></a>
</h2>
<p>We use direct standardization with the same standard weights as in Munter et al.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15.5</span>, <span class="fl">45.4</span>, <span class="fl">21.5</span>, <span class="fl">17.7</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="nhanes-design-objects">NHANES design objects<a class="anchor" aria-label="anchor" href="#nhanes-design-objects"></a>
</h2>
<p>In most cases, we use <code><a href="../reference/nhanes_summarize.html">nhanes_summarize()</a></code> or <code>nhanes_visualize</code> when generating results with <code>cardioStatsUSA</code>. In this case, we find it’s easier to use the <code>nhanes_design</code> family of functions, which are the lower level functions that support <code>nhanes_summarize</code> and <code>nhanes_visualize</code>. Full details on this family can be found at the help page for [nhanes_design]. For this analysis, we create three designs:</p>
<ul>
<li>an initial design that encapsulates the two others:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_init</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nhanes_design.html">nhanes_design</a></span><span class="op">(</span></span>
<span> data <span class="op">=</span> <span class="va">nhanes_data</span><span class="op">[</span><span class="va">svy_subpop_htn</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>,</span>
<span> key <span class="op">=</span> <span class="va">nhanes_key</span>,</span>
<span> outcome_variable <span class="op">=</span> <span class="st">'bp_control_jnc7'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li>a design for non-pregnant adults with hypertension</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_all</span> <span class="op">&lt;-</span> <span class="va">ds_init</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_subset.html">nhanes_design_subset</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="va">demo_pregnant</span> <span class="op">==</span> <span class="st">'No'</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">demo_pregnant</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>   <span class="va">htn_jnc7</span> <span class="op">==</span> <span class="st">'Yes'</span></span>
<span> <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_standardize.html">nhanes_design_standardize</a></span><span class="op">(</span>standard_weights <span class="op">=</span> <span class="va">standard_weights</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>a design for non-pregnant adults with hypertension who reported using antihypertensive medication</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_meds</span> <span class="op">&lt;-</span> <span class="va">ds_init</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_subset.html">nhanes_design_subset</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="va">demo_pregnant</span> <span class="op">==</span> <span class="st">'No'</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">demo_pregnant</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>   <span class="va">htn_jnc7</span> <span class="op">==</span> <span class="st">'Yes'</span> <span class="op">&amp;</span></span>
<span>   <span class="va">bp_med_use</span> <span class="op">==</span> <span class="st">'Yes'</span></span>
<span> <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_standardize.html">nhanes_design_standardize</a></span><span class="op">(</span>standard_weights <span class="op">=</span> <span class="va">standard_weights</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="replicating-etable-1">Replicating eTable 1<a class="anchor" aria-label="anchor" href="#replicating-etable-1"></a>
</h2>
<p>To reproduce eTable 1 from Muntner et al, we use the <code>ds_meds</code> design object to estimate the proportion of adults with BP control according to the JNC7 BP guidelines.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shiny_answers_etable_1_overall</span> <span class="op">&lt;-</span> <span class="va">ds_meds</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_summarize.html">nhanes_design_summarize</a></span><span class="op">(</span>outcome_stats <span class="op">=</span> <span class="st">'percentage'</span>,</span>
<span>                         simplify_output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bp_control_jnc7</span><span class="op">==</span><span class="st">'Yes'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>group <span class="op">=</span> <span class="st">'Overall'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shiny_answers_etable_1_by_age</span> <span class="op">&lt;-</span> <span class="va">ds_meds</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_update.html">nhanes_design_update</a></span><span class="op">(</span>group_variable <span class="op">=</span> <span class="st">'demo_age_cat'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_summarize.html">nhanes_design_summarize</a></span><span class="op">(</span>outcome_stats <span class="op">=</span> <span class="st">'percentage'</span>,</span>
<span>                         simplify_output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bp_control_jnc7</span><span class="op">==</span><span class="st">'Yes'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">demo_age_cat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shiny_answers_etable_1_by_sex</span> <span class="op">&lt;-</span> <span class="va">ds_meds</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_update.html">nhanes_design_update</a></span><span class="op">(</span>group_variable <span class="op">=</span> <span class="st">'demo_gender'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_summarize.html">nhanes_design_summarize</a></span><span class="op">(</span>outcome_stats <span class="op">=</span> <span class="st">'percentage'</span>,</span>
<span>                         simplify_output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bp_control_jnc7</span><span class="op">==</span><span class="st">'Yes'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">demo_gender</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shiny_answers_etable_1_by_race</span> <span class="op">&lt;-</span> <span class="va">ds_meds</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_update.html">nhanes_design_update</a></span><span class="op">(</span>group_variable <span class="op">=</span> <span class="st">'demo_race'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="../reference/nhanes_design_summarize.html">nhanes_design_summarize</a></span><span class="op">(</span>outcome_stats <span class="op">=</span> <span class="st">'percentage'</span>,</span>
<span>                         simplify_output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bp_control_jnc7</span><span class="op">==</span><span class="st">'Yes'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">demo_race</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">!=</span> <span class="st">'Other'</span><span class="op">)</span></span></code></pre></div>
<p>Now we can put all of our answers together</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># names of columns that contain model estimates</span></span>
<span><span class="va">est_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'estimate'</span>, <span class="st">'ci_lower'</span>, <span class="st">'ci_upper'</span><span class="op">)</span></span>
<span><span class="co"># names of columns to include for comparison to Muntner et al</span></span>
<span><span class="va">muntner_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'svy_year'</span>, <span class="st">'group'</span>, <span class="st">'estimate'</span>, <span class="st">'ci_lower'</span>, <span class="st">'ci_upper'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shiny_answers_etable_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span> <span class="va">shiny_answers_etable_1_overall</span>,</span>
<span> <span class="va">shiny_answers_etable_1_by_age</span>,</span>
<span> <span class="va">shiny_answers_etable_1_by_sex</span>,</span>
<span> <span class="va">shiny_answers_etable_1_by_race</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu">rbindlist</span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="va">.</span><span class="op">[</span>, <span class="op">(</span><span class="va">est_cols</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">round</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, .SDcols <span class="op">=</span> <span class="va">est_cols</span><span class="op">]</span> <span class="op">%&gt;%</span></span>
<span> <span class="va">.</span><span class="op">[</span>, <span class="va">.SD</span>, .SDcols <span class="op">=</span> <span class="va">muntner_cols</span><span class="op">]</span></span>
<span></span>
<span><span class="va">shiny_answers_etable_1</span></span>
<span><span class="co">#&gt;       svy_year              group estimate ci_lower ci_upper</span></span>
<span><span class="co">#&gt;   1: 1999-2000            Overall     53.4     49.0     57.9</span></span>
<span><span class="co">#&gt;   2: 2001-2002            Overall     58.6     56.0     61.2</span></span>
<span><span class="co">#&gt;   3: 2003-2004            Overall     62.1     57.9     66.2</span></span>
<span><span class="co">#&gt;   4: 2005-2006            Overall     65.5     62.0     69.0</span></span>
<span><span class="co">#&gt;   5: 2007-2008            Overall     68.3     65.9     70.7</span></span>
<span><span class="co">#&gt;  ---                                                        </span></span>
<span><span class="co">#&gt; 100: 2015-2016           Hispanic     65.0     58.8     71.1</span></span>
<span><span class="co">#&gt; 101: 2017-2020 Non-Hispanic White     72.1     68.8     75.3</span></span>
<span><span class="co">#&gt; 102: 2017-2020 Non-Hispanic Black     52.6     47.3     57.9</span></span>
<span><span class="co">#&gt; 103: 2017-2020 Non-Hispanic Asian     63.6     57.0     70.1</span></span>
<span><span class="co">#&gt; 104: 2017-2020           Hispanic     62.3     56.9     67.7</span></span></code></pre></div>
<p>We also need to get the data from Muntner et al to make sure our answers match their answers. There isn’t really an easy way to load these data programmatically, so they are written manually into a data set here.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jama_etable_1</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span> <span class="op">~</span><span class="va">svy_year</span>,   <span class="op">~</span><span class="va">group</span>              , <span class="op">~</span><span class="va">estimate</span>, <span class="op">~</span><span class="va">ci_lower</span>, <span class="op">~</span><span class="va">ci_upper</span>,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">53.4</span>    ,  <span class="fl">49.0</span>    ,  <span class="fl">57.9</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">58.6</span>    ,  <span class="fl">56.0</span>    ,  <span class="fl">61.2</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">62.1</span>    ,  <span class="fl">57.9</span>    ,  <span class="fl">66.2</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">65.5</span>    ,  <span class="fl">62.0</span>    ,  <span class="fl">69.0</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">68.3</span>    ,  <span class="fl">65.9</span>    ,  <span class="fl">70.8</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">69.7</span>    ,  <span class="fl">67.4</span>    ,  <span class="fl">72.1</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">70.3</span>    ,  <span class="fl">66.8</span>    ,  <span class="fl">73.8</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">72.2</span>    ,  <span class="fl">68.6</span>    ,  <span class="fl">75.8</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">66.8</span>    ,  <span class="fl">63.0</span>    ,  <span class="fl">70.6</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"Overall"</span>           ,  <span class="fl">64.8</span>    ,  <span class="fl">61.3</span>    ,  <span class="fl">68.3</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">66.1</span>    ,  <span class="fl">54.7</span>    ,  <span class="fl">77.5</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">70.8</span>    ,  <span class="fl">60.4</span>    ,  <span class="fl">81.1</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">81.7</span>    ,  <span class="fl">73.2</span>    ,  <span class="fl">90.2</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">77.2</span>    ,  <span class="fl">67.1</span>    ,  <span class="fl">87.4</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">83.7</span>    ,  <span class="fl">78.6</span>    ,  <span class="fl">88.7</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">65.5</span>    ,  <span class="fl">56.0</span>    ,  <span class="fl">74.9</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">83.3</span>    ,  <span class="fl">74.2</span>    ,  <span class="fl">92.4</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">81.0</span>    ,  <span class="fl">76.0</span>    ,  <span class="fl">85.9</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">70.9</span>    ,  <span class="fl">63.2</span>    ,  <span class="fl">78.6</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"18 to 44"</span>          ,  <span class="fl">73.3</span>    ,  <span class="fl">60.5</span>    ,  <span class="fl">86.0</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">60.6</span>    ,  <span class="fl">55.1</span>    ,  <span class="fl">66.1</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">63.3</span>    ,  <span class="fl">58.6</span>    ,  <span class="fl">68.1</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">63.9</span>    ,  <span class="fl">58.6</span>    ,  <span class="fl">69.2</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">68.8</span>    ,  <span class="fl">63.1</span>    ,  <span class="fl">74.5</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">69.8</span>    ,  <span class="fl">65.5</span>    ,  <span class="fl">74.1</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">73.4</span>    ,  <span class="fl">69.6</span>    ,  <span class="fl">77.3</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">74.6</span>    ,  <span class="fl">70.6</span>    ,  <span class="fl">78.5</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">75.2</span>    ,  <span class="fl">69.7</span>    ,  <span class="fl">80.7</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">74.0</span>    ,  <span class="fl">68.1</span>    ,  <span class="fl">79.9</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"45 to 64"</span>          ,  <span class="fl">69.1</span>    ,  <span class="fl">64.6</span>    ,  <span class="fl">73.6</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">50.0</span>    ,  <span class="fl">43.2</span>    ,  <span class="fl">56.9</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">49.8</span>    ,  <span class="fl">43.1</span>    ,  <span class="fl">56.5</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">58.7</span>    ,  <span class="fl">51.9</span>    ,  <span class="fl">65.5</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">58.8</span>    ,  <span class="fl">53.7</span>    ,  <span class="fl">63.9</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">66.1</span>    ,  <span class="fl">62.2</span>    ,  <span class="fl">70.0</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">71.5</span>    ,  <span class="fl">67.5</span>    ,  <span class="fl">75.6</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">68.6</span>    ,  <span class="fl">62.0</span>    ,  <span class="fl">75.2</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">70.6</span>    ,  <span class="fl">66.4</span>    ,  <span class="fl">74.7</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">64.4</span>    ,  <span class="fl">56.7</span>    ,  <span class="fl">72.2</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"65 to 74"</span>          ,  <span class="fl">64.3</span>    ,  <span class="fl">56.9</span>    ,  <span class="fl">71.7</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"75+"</span>               ,  <span class="fl">28.1</span>    ,  <span class="fl">22.0</span>    ,  <span class="fl">34.3</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"75+"</span>               ,  <span class="fl">46.5</span>    ,  <span class="fl">36.9</span>    ,  <span class="fl">56.2</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"75+"</span>               ,  <span class="fl">44.1</span>    ,  <span class="fl">38.2</span>    ,  <span class="fl">50.1</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"75+"</span>               ,  <span class="fl">55.0</span>    ,  <span class="fl">48.3</span>    ,  <span class="fl">61.7</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"75+"</span>               ,  <span class="fl">53.9</span>    ,  <span class="fl">48.5</span>    ,  <span class="fl">59.2</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"75+"</span>               ,  <span class="fl">61.7</span>    ,  <span class="fl">55.8</span>    ,  <span class="fl">67.6</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"75+"</span>               ,  <span class="fl">49.9</span>    ,  <span class="fl">41.7</span>    ,  <span class="fl">58.1</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"75+"</span>               ,  <span class="fl">58.5</span>    ,  <span class="fl">50.4</span>    ,  <span class="fl">66.7</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"75+"</span>               ,  <span class="fl">47.7</span>    ,  <span class="fl">39.2</span>    ,  <span class="fl">56.2</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"75+"</span>               ,  <span class="fl">46.9</span>    ,  <span class="fl">39.9</span>    ,  <span class="fl">53.9</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"Women"</span>             ,  <span class="fl">49.6</span>    ,  <span class="fl">44.6</span>    ,  <span class="fl">54.5</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"Women"</span>             ,  <span class="fl">57.5</span>    ,  <span class="fl">53.8</span>    ,  <span class="fl">61.1</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"Women"</span>             ,  <span class="fl">59.4</span>    ,  <span class="fl">54.2</span>    ,  <span class="fl">64.6</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"Women"</span>             ,  <span class="fl">63.8</span>    ,  <span class="fl">60.0</span>    ,  <span class="fl">67.6</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"Women"</span>             ,  <span class="fl">67.5</span>    ,  <span class="fl">64.7</span>    ,  <span class="fl">70.3</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"Women"</span>             ,  <span class="fl">71.4</span>    ,  <span class="fl">68.7</span>    ,  <span class="fl">74.0</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"Women"</span>             ,  <span class="fl">70.2</span>    ,  <span class="fl">65.6</span>    ,  <span class="fl">74.7</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"Women"</span>             ,  <span class="fl">72.4</span>    ,  <span class="fl">68.1</span>    ,  <span class="fl">76.7</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"Women"</span>             ,  <span class="fl">67.9</span>    ,  <span class="fl">63.9</span>    ,  <span class="fl">71.9</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"Women"</span>             ,  <span class="fl">63.0</span>    ,  <span class="fl">59.1</span>    ,  <span class="fl">66.8</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"Men"</span>               ,  <span class="fl">59.2</span>    ,  <span class="fl">51.3</span>    ,  <span class="fl">67.1</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"Men"</span>               ,  <span class="fl">61.3</span>    ,  <span class="fl">55.8</span>    ,  <span class="fl">66.8</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"Men"</span>               ,  <span class="fl">65.5</span>    ,  <span class="fl">60.6</span>    ,  <span class="fl">70.3</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"Men"</span>               ,  <span class="fl">68.4</span>    ,  <span class="fl">62.7</span>    ,  <span class="fl">74.1</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"Men"</span>               ,  <span class="fl">69.4</span>    ,  <span class="fl">66.2</span>    ,  <span class="fl">72.6</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"Men"</span>               ,  <span class="fl">68.4</span>    ,  <span class="fl">64.5</span>    ,  <span class="fl">72.3</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"Men"</span>               ,  <span class="fl">71.1</span>    ,  <span class="fl">67.1</span>    ,  <span class="fl">75.1</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"Men"</span>               ,  <span class="fl">72.6</span>    ,  <span class="fl">67.5</span>    ,  <span class="fl">77.8</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"Men"</span>               ,  <span class="fl">66.5</span>    ,  <span class="fl">61.1</span>    ,  <span class="fl">71.8</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"Men"</span>               ,  <span class="fl">67.1</span>    ,  <span class="fl">62.5</span>    ,  <span class="fl">71.8</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">57.3</span>    ,  <span class="fl">51.9</span>    ,  <span class="fl">62.8</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">61.3</span>    ,  <span class="fl">57.2</span>    ,  <span class="fl">65.4</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">65.1</span>    ,  <span class="fl">60.6</span>    ,  <span class="fl">69.6</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">67.1</span>    ,  <span class="fl">62.9</span>    ,  <span class="fl">71.2</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">71.0</span>    ,  <span class="fl">68.3</span>    ,  <span class="fl">73.7</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">73.4</span>    ,  <span class="fl">70.7</span>    ,  <span class="fl">76.1</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">72.3</span>    ,  <span class="fl">68.5</span>    ,  <span class="fl">76.2</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">75.4</span>    ,  <span class="fl">70.4</span>    ,  <span class="fl">80.4</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">70.4</span>    ,  <span class="fl">65.6</span>    ,  <span class="fl">75.2</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"Non-Hispanic White"</span>,  <span class="fl">68.2</span>    ,  <span class="fl">63.5</span>    ,  <span class="fl">72.9</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">44.3</span>    ,  <span class="fl">37.1</span>    ,  <span class="fl">51.5</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">48.6</span>    ,  <span class="fl">45.7</span>    ,  <span class="fl">51.6</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">55.6</span>    ,  <span class="fl">49.0</span>    ,  <span class="fl">62.2</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">57.9</span>    ,  <span class="fl">51.9</span>    ,  <span class="fl">63.9</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">61.1</span>    ,  <span class="fl">56.7</span>    ,  <span class="fl">65.6</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">60.1</span>    ,  <span class="fl">56.0</span>    ,  <span class="fl">64.1</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">64.2</span>    ,  <span class="fl">58.9</span>    ,  <span class="fl">69.4</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">60.4</span>    ,  <span class="fl">54.4</span>    ,  <span class="fl">66.5</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">58.1</span>    ,  <span class="fl">53.0</span>    ,  <span class="fl">63.2</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"Non-Hispanic Black"</span>,  <span class="fl">53.2</span>    ,  <span class="fl">47.5</span>    ,  <span class="fl">58.9</span>    ,</span>
<span> <span class="st">"1999-2000"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">48.8</span>    ,  <span class="fl">39.3</span>    ,  <span class="fl">58.3</span>    ,</span>
<span> <span class="st">"2001-2002"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">61.7</span>    ,  <span class="fl">51.0</span>    ,  <span class="fl">72.4</span>    ,</span>
<span> <span class="st">"2003-2004"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">54.5</span>    ,  <span class="fl">40.9</span>    ,  <span class="fl">68.1</span>    ,</span>
<span> <span class="st">"2005-2006"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">64.2</span>    ,  <span class="fl">57.1</span>    ,  <span class="fl">71.4</span>    ,</span>
<span> <span class="st">"2007-2008"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">64.3</span>    ,  <span class="fl">57.7</span>    ,  <span class="fl">70.9</span>    ,</span>
<span> <span class="st">"2009-2010"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">58.1</span>    ,  <span class="fl">52.3</span>    ,  <span class="fl">64.1</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">65.4</span>    ,  <span class="fl">59.5</span>    ,  <span class="fl">71.2</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">68.9</span>    ,  <span class="fl">61.8</span>    ,  <span class="fl">75.9</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">65.0</span>    ,  <span class="fl">58.8</span>    ,  <span class="fl">71.2</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"Hispanic"</span>          ,  <span class="fl">58.2</span>    ,  <span class="fl">48.7</span>    ,  <span class="fl">67.7</span>    ,</span>
<span> <span class="st">"2011-2012"</span>, <span class="st">"Non-Hispanic Asian"</span>,  <span class="fl">72.5</span>    ,  <span class="fl">62.3</span>    ,  <span class="fl">82.6</span>    ,</span>
<span> <span class="st">"2013-2014"</span>, <span class="st">"Non-Hispanic Asian"</span>,  <span class="fl">63.8</span>    ,  <span class="fl">57.2</span>    ,  <span class="fl">70.5</span>    ,</span>
<span> <span class="st">"2015-2016"</span>, <span class="st">"Non-Hispanic Asian"</span>,  <span class="fl">54.1</span>    ,  <span class="fl">43.8</span>    ,  <span class="fl">64.4</span>    ,</span>
<span> <span class="st">"2017-2018"</span>, <span class="st">"Non-Hispanic Asian"</span>,  <span class="fl">63.7</span>    ,  <span class="fl">58.9</span>    ,  <span class="fl">68.5</span>    <span class="op">)</span></span></code></pre></div>
<p>Now put everything together and test that all of our answers match</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span> jama <span class="op">=</span> <span class="va">jama_etable_1</span>,</span>
<span> shiny <span class="op">=</span> <span class="va">shiny_answers_etable_1</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu">rbindlist</span><span class="op">(</span>idcol <span class="op">=</span> <span class="st">'source'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="va">.</span><span class="op">[</span><span class="op">!</span><span class="va">svy_year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2017-2018'</span>, <span class="st">'2017-2020'</span><span class="op">)</span><span class="op">]</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu">dcast</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">svy_year</span> <span class="op">+</span> <span class="va">group</span> <span class="op">~</span> <span class="va">source</span>, value.var <span class="op">=</span> <span class="va">est_cols</span><span class="op">)</span></span></code></pre></div>
<p>take a look at the merged results, you can see estimate_shiny matches estimate_jama in all cells shown.</p>
<pre><code><span><span class="co">#&gt;      svy_year              group estimate_jama estimate_shiny ci_lower_jama</span></span>
<span><span class="co">#&gt;  1: 1999-2000           18 to 44          66.1           66.1          54.7</span></span>
<span><span class="co">#&gt;  2: 1999-2000           45 to 64          60.6           60.6          55.1</span></span>
<span><span class="co">#&gt;  3: 1999-2000           65 to 74          50.0           50.0          43.2</span></span>
<span><span class="co">#&gt;  4: 1999-2000                75+          28.1           28.1          22.0</span></span>
<span><span class="co">#&gt;  5: 1999-2000           Hispanic          48.8           48.8          39.3</span></span>
<span><span class="co">#&gt;  6: 1999-2000                Men          59.2           59.2          51.3</span></span>
<span><span class="co">#&gt;  7: 1999-2000 Non-Hispanic Black          44.3           44.3          37.1</span></span>
<span><span class="co">#&gt;  8: 1999-2000 Non-Hispanic White          57.3           57.3          51.9</span></span>
<span><span class="co">#&gt;  9: 1999-2000            Overall          53.4           53.4          49.0</span></span>
<span><span class="co">#&gt; 10: 1999-2000              Women          49.6           49.6          44.6</span></span>
<span><span class="co">#&gt; 11: 2001-2002           18 to 44          70.8           70.8          60.4</span></span>
<span><span class="co">#&gt; 12: 2001-2002           45 to 64          63.3           63.3          58.6</span></span>
<span><span class="co">#&gt; 13: 2001-2002           65 to 74          49.8           49.8          43.1</span></span>
<span><span class="co">#&gt; 14: 2001-2002                75+          46.5           46.5          36.9</span></span>
<span><span class="co">#&gt; 15: 2001-2002           Hispanic          61.7           61.7          51.0</span></span>
<span><span class="co">#&gt; 16: 2001-2002                Men          61.3           61.3          55.8</span></span>
<span><span class="co">#&gt; 17: 2001-2002 Non-Hispanic Black          48.6           48.6          45.7</span></span>
<span><span class="co">#&gt; 18: 2001-2002 Non-Hispanic White          61.3           61.3          57.2</span></span>
<span><span class="co">#&gt; 19: 2001-2002            Overall          58.6           58.6          56.0</span></span>
<span><span class="co">#&gt; 20: 2001-2002              Women          57.5           57.5          53.8</span></span>
<span><span class="co">#&gt; 21: 2003-2004           18 to 44          81.7           81.7          73.2</span></span>
<span><span class="co">#&gt; 22: 2003-2004           45 to 64          63.9           63.9          58.6</span></span>
<span><span class="co">#&gt; 23: 2003-2004           65 to 74          58.7           58.7          51.9</span></span>
<span><span class="co">#&gt; 24: 2003-2004                75+          44.1           44.1          38.2</span></span>
<span><span class="co">#&gt; 25: 2003-2004           Hispanic          54.5           54.5          40.9</span></span>
<span><span class="co">#&gt; 26: 2003-2004                Men          65.5           65.5          60.6</span></span>
<span><span class="co">#&gt; 27: 2003-2004 Non-Hispanic Black          55.6           55.6          49.0</span></span>
<span><span class="co">#&gt; 28: 2003-2004 Non-Hispanic White          65.1           65.1          60.6</span></span>
<span><span class="co">#&gt; 29: 2003-2004            Overall          62.1           62.1          57.9</span></span>
<span><span class="co">#&gt; 30: 2003-2004              Women          59.4           59.4          54.2</span></span>
<span><span class="co">#&gt; 31: 2005-2006           18 to 44          77.2           77.2          67.1</span></span>
<span><span class="co">#&gt; 32: 2005-2006           45 to 64          68.8           68.8          63.1</span></span>
<span><span class="co">#&gt; 33: 2005-2006           65 to 74          58.8           58.8          53.7</span></span>
<span><span class="co">#&gt; 34: 2005-2006                75+          55.0           55.0          48.3</span></span>
<span><span class="co">#&gt; 35: 2005-2006           Hispanic          64.2           64.2          57.1</span></span>
<span><span class="co">#&gt; 36: 2005-2006                Men          68.4           68.4          62.7</span></span>
<span><span class="co">#&gt; 37: 2005-2006 Non-Hispanic Black          57.9           57.9          51.9</span></span>
<span><span class="co">#&gt; 38: 2005-2006 Non-Hispanic White          67.1           67.1          62.9</span></span>
<span><span class="co">#&gt; 39: 2005-2006            Overall          65.5           65.5          62.0</span></span>
<span><span class="co">#&gt; 40: 2005-2006              Women          63.8           63.8          60.0</span></span>
<span><span class="co">#&gt; 41: 2007-2008           18 to 44          83.7           83.7          78.6</span></span>
<span><span class="co">#&gt; 42: 2007-2008           45 to 64          69.8           69.8          65.5</span></span>
<span><span class="co">#&gt; 43: 2007-2008           65 to 74          66.1           66.1          62.2</span></span>
<span><span class="co">#&gt; 44: 2007-2008                75+          53.9           53.9          48.5</span></span>
<span><span class="co">#&gt; 45: 2007-2008           Hispanic          64.3           64.3          57.7</span></span>
<span><span class="co">#&gt; 46: 2007-2008                Men          69.4           69.4          66.2</span></span>
<span><span class="co">#&gt; 47: 2007-2008 Non-Hispanic Black          61.1           61.1          56.7</span></span>
<span><span class="co">#&gt; 48: 2007-2008 Non-Hispanic White          71.0           71.0          68.3</span></span>
<span><span class="co">#&gt; 49: 2007-2008            Overall          68.3           68.3          65.9</span></span>
<span><span class="co">#&gt; 50: 2007-2008              Women          67.5           67.5          64.7</span></span>
<span><span class="co">#&gt; 51: 2009-2010           18 to 44          65.5           65.5          56.0</span></span>
<span><span class="co">#&gt; 52: 2009-2010           45 to 64          73.4           73.4          69.6</span></span>
<span><span class="co">#&gt; 53: 2009-2010           65 to 74          71.5           71.5          67.5</span></span>
<span><span class="co">#&gt; 54: 2009-2010                75+          61.7           61.7          55.8</span></span>
<span><span class="co">#&gt; 55: 2009-2010           Hispanic          58.1           58.1          52.3</span></span>
<span><span class="co">#&gt; 56: 2009-2010                Men          68.4           68.4          64.5</span></span>
<span><span class="co">#&gt; 57: 2009-2010 Non-Hispanic Black          60.1           60.1          56.0</span></span>
<span><span class="co">#&gt; 58: 2009-2010 Non-Hispanic White          73.4           73.4          70.7</span></span>
<span><span class="co">#&gt; 59: 2009-2010            Overall          69.7           69.7          67.4</span></span>
<span><span class="co">#&gt; 60: 2009-2010              Women          71.4           71.4          68.7</span></span>
<span><span class="co">#&gt; 61: 2011-2012           18 to 44          83.3           83.3          74.2</span></span>
<span><span class="co">#&gt; 62: 2011-2012           45 to 64          74.6           74.6          70.6</span></span>
<span><span class="co">#&gt; 63: 2011-2012           65 to 74          68.6           68.6          62.0</span></span>
<span><span class="co">#&gt; 64: 2011-2012                75+          49.9           49.9          41.7</span></span>
<span><span class="co">#&gt; 65: 2011-2012           Hispanic          65.4           65.4          59.5</span></span>
<span><span class="co">#&gt; 66: 2011-2012                Men          71.1           71.1          67.1</span></span>
<span><span class="co">#&gt; 67: 2011-2012 Non-Hispanic Asian          72.5           72.5          62.3</span></span>
<span><span class="co">#&gt; 68: 2011-2012 Non-Hispanic Black          64.2           64.2          58.9</span></span>
<span><span class="co">#&gt; 69: 2011-2012 Non-Hispanic White          72.3           72.3          68.5</span></span>
<span><span class="co">#&gt; 70: 2011-2012            Overall          70.3           70.3          66.8</span></span>
<span><span class="co">#&gt; 71: 2011-2012              Women          70.2           70.2          65.6</span></span>
<span><span class="co">#&gt; 72: 2013-2014           18 to 44          81.0           81.0          76.0</span></span>
<span><span class="co">#&gt; 73: 2013-2014           45 to 64          75.2           75.2          69.7</span></span>
<span><span class="co">#&gt; 74: 2013-2014           65 to 74          70.6           70.6          66.4</span></span>
<span><span class="co">#&gt; 75: 2013-2014                75+          58.5           58.5          50.4</span></span>
<span><span class="co">#&gt; 76: 2013-2014           Hispanic          68.9           68.9          61.8</span></span>
<span><span class="co">#&gt; 77: 2013-2014                Men          72.6           72.6          67.5</span></span>
<span><span class="co">#&gt; 78: 2013-2014 Non-Hispanic Asian          63.8           63.8          57.2</span></span>
<span><span class="co">#&gt; 79: 2013-2014 Non-Hispanic Black          60.4           60.4          54.4</span></span>
<span><span class="co">#&gt; 80: 2013-2014 Non-Hispanic White          75.4           75.4          70.4</span></span>
<span><span class="co">#&gt; 81: 2013-2014            Overall          72.2           72.2          68.6</span></span>
<span><span class="co">#&gt; 82: 2013-2014              Women          72.4           72.4          68.1</span></span>
<span><span class="co">#&gt; 83: 2015-2016           18 to 44          70.9           70.9          63.2</span></span>
<span><span class="co">#&gt; 84: 2015-2016           45 to 64          74.0           74.0          68.1</span></span>
<span><span class="co">#&gt; 85: 2015-2016           65 to 74          64.4           64.4          56.7</span></span>
<span><span class="co">#&gt; 86: 2015-2016                75+          47.7           47.7          39.2</span></span>
<span><span class="co">#&gt; 87: 2015-2016           Hispanic          65.0           65.0          58.8</span></span>
<span><span class="co">#&gt; 88: 2015-2016                Men          66.5           66.5          61.1</span></span>
<span><span class="co">#&gt; 89: 2015-2016 Non-Hispanic Asian          54.1           54.1          43.8</span></span>
<span><span class="co">#&gt; 90: 2015-2016 Non-Hispanic Black          58.1           58.1          53.0</span></span>
<span><span class="co">#&gt; 91: 2015-2016 Non-Hispanic White          70.4           70.4          65.6</span></span>
<span><span class="co">#&gt; 92: 2015-2016            Overall          66.8           66.8          63.0</span></span>
<span><span class="co">#&gt; 93: 2015-2016              Women          67.9           67.9          63.9</span></span>
<span><span class="co">#&gt;      svy_year              group estimate_jama estimate_shiny ci_lower_jama</span></span>
<span><span class="co">#&gt;     ci_lower_shiny ci_upper_jama ci_upper_shiny</span></span>
<span><span class="co">#&gt;  1:           54.8          77.5           77.4</span></span>
<span><span class="co">#&gt;  2:           55.1          66.1           66.0</span></span>
<span><span class="co">#&gt;  3:           43.3          56.9           56.8</span></span>
<span><span class="co">#&gt;  4:           22.0          34.3           34.2</span></span>
<span><span class="co">#&gt;  5:           39.4          58.3           58.2</span></span>
<span><span class="co">#&gt;  6:           51.3          67.1           67.0</span></span>
<span><span class="co">#&gt;  7:           37.2          51.5           51.5</span></span>
<span><span class="co">#&gt;  8:           51.9          62.8           62.7</span></span>
<span><span class="co">#&gt;  9:           49.0          57.9           57.9</span></span>
<span><span class="co">#&gt; 10:           44.7          54.5           54.5</span></span>
<span><span class="co">#&gt; 11:           60.5          81.1           81.0</span></span>
<span><span class="co">#&gt; 12:           58.6          68.1           68.0</span></span>
<span><span class="co">#&gt; 13:           43.1          56.5           56.4</span></span>
<span><span class="co">#&gt; 14:           37.0          56.2           56.1</span></span>
<span><span class="co">#&gt; 15:           51.1          72.4           72.3</span></span>
<span><span class="co">#&gt; 16:           55.9          66.8           66.7</span></span>
<span><span class="co">#&gt; 17:           45.7          51.6           51.6</span></span>
<span><span class="co">#&gt; 18:           57.2          65.4           65.4</span></span>
<span><span class="co">#&gt; 19:           56.0          61.2           61.2</span></span>
<span><span class="co">#&gt; 20:           53.8          61.1           61.1</span></span>
<span><span class="co">#&gt; 21:           73.2          90.2           90.2</span></span>
<span><span class="co">#&gt; 22:           58.7          69.2           69.2</span></span>
<span><span class="co">#&gt; 23:           51.9          65.5           65.4</span></span>
<span><span class="co">#&gt; 24:           38.2          50.1           50.1</span></span>
<span><span class="co">#&gt; 25:           41.0          68.1           68.0</span></span>
<span><span class="co">#&gt; 26:           60.6          70.3           70.3</span></span>
<span><span class="co">#&gt; 27:           49.0          62.2           62.1</span></span>
<span><span class="co">#&gt; 28:           60.6          69.6           69.6</span></span>
<span><span class="co">#&gt; 29:           57.9          66.2           66.2</span></span>
<span><span class="co">#&gt; 30:           54.2          64.6           64.5</span></span>
<span><span class="co">#&gt; 31:           67.2          87.4           87.3</span></span>
<span><span class="co">#&gt; 32:           63.2          74.5           74.4</span></span>
<span><span class="co">#&gt; 33:           53.7          63.9           63.9</span></span>
<span><span class="co">#&gt; 34:           48.3          61.7           61.7</span></span>
<span><span class="co">#&gt; 35:           57.1          71.4           71.4</span></span>
<span><span class="co">#&gt; 36:           62.7          74.1           74.1</span></span>
<span><span class="co">#&gt; 37:           52.0          63.9           63.9</span></span>
<span><span class="co">#&gt; 38:           63.0          71.2           71.2</span></span>
<span><span class="co">#&gt; 39:           62.0          69.0           69.0</span></span>
<span><span class="co">#&gt; 40:           60.0          67.6           67.6</span></span>
<span><span class="co">#&gt; 41:           78.6          88.7           88.7</span></span>
<span><span class="co">#&gt; 42:           65.5          74.1           74.0</span></span>
<span><span class="co">#&gt; 43:           62.2          70.0           69.9</span></span>
<span><span class="co">#&gt; 44:           48.6          59.2           59.2</span></span>
<span><span class="co">#&gt; 45:           57.7          70.9           70.8</span></span>
<span><span class="co">#&gt; 46:           66.2          72.6           72.6</span></span>
<span><span class="co">#&gt; 47:           56.7          65.6           65.5</span></span>
<span><span class="co">#&gt; 48:           68.4          73.7           73.6</span></span>
<span><span class="co">#&gt; 49:           65.9          70.8           70.7</span></span>
<span><span class="co">#&gt; 50:           64.8          70.3           70.3</span></span>
<span><span class="co">#&gt; 51:           56.1          74.9           74.9</span></span>
<span><span class="co">#&gt; 52:           69.6          77.3           77.2</span></span>
<span><span class="co">#&gt; 53:           67.6          75.6           75.5</span></span>
<span><span class="co">#&gt; 54:           55.8          67.6           67.6</span></span>
<span><span class="co">#&gt; 55:           52.1          64.1           64.1</span></span>
<span><span class="co">#&gt; 56:           64.5          72.3           72.3</span></span>
<span><span class="co">#&gt; 57:           56.0          64.1           64.1</span></span>
<span><span class="co">#&gt; 58:           70.7          76.1           76.1</span></span>
<span><span class="co">#&gt; 59:           67.4          72.1           72.1</span></span>
<span><span class="co">#&gt; 60:           68.8          74.0           74.0</span></span>
<span><span class="co">#&gt; 61:           74.3          92.4           92.3</span></span>
<span><span class="co">#&gt; 62:           70.7          78.5           78.5</span></span>
<span><span class="co">#&gt; 63:           62.1          75.2           75.1</span></span>
<span><span class="co">#&gt; 64:           41.8          58.1           58.1</span></span>
<span><span class="co">#&gt; 65:           59.6          71.2           71.2</span></span>
<span><span class="co">#&gt; 66:           67.1          75.1           75.1</span></span>
<span><span class="co">#&gt; 67:           62.5          82.6           82.4</span></span>
<span><span class="co">#&gt; 68:           59.0          69.4           69.4</span></span>
<span><span class="co">#&gt; 69:           68.5          76.2           76.2</span></span>
<span><span class="co">#&gt; 70:           66.8          73.8           73.7</span></span>
<span><span class="co">#&gt; 71:           65.6          74.7           74.7</span></span>
<span><span class="co">#&gt; 72:           76.1          85.9           85.9</span></span>
<span><span class="co">#&gt; 73:           69.8          80.7           80.7</span></span>
<span><span class="co">#&gt; 74:           66.4          74.7           74.7</span></span>
<span><span class="co">#&gt; 75:           50.5          66.7           66.6</span></span>
<span><span class="co">#&gt; 76:           61.9          75.9           75.9</span></span>
<span><span class="co">#&gt; 77:           67.6          77.8           77.7</span></span>
<span><span class="co">#&gt; 78:           57.3          70.5           70.4</span></span>
<span><span class="co">#&gt; 79:           54.4          66.5           66.4</span></span>
<span><span class="co">#&gt; 80:           70.5          80.4           80.3</span></span>
<span><span class="co">#&gt; 81:           68.6          75.8           75.7</span></span>
<span><span class="co">#&gt; 82:           68.1          76.7           76.7</span></span>
<span><span class="co">#&gt; 83:           63.3          78.6           78.5</span></span>
<span><span class="co">#&gt; 84:           68.1          79.9           79.9</span></span>
<span><span class="co">#&gt; 85:           56.7          72.2           72.1</span></span>
<span><span class="co">#&gt; 86:           39.3          56.2           56.1</span></span>
<span><span class="co">#&gt; 87:           58.8          71.2           71.1</span></span>
<span><span class="co">#&gt; 88:           61.2          71.8           71.8</span></span>
<span><span class="co">#&gt; 89:           44.1          64.4           64.2</span></span>
<span><span class="co">#&gt; 90:           53.0          63.2           63.2</span></span>
<span><span class="co">#&gt; 91:           65.6          75.2           75.2</span></span>
<span><span class="co">#&gt; 92:           63.0          70.6           70.6</span></span>
<span><span class="co">#&gt; 93:           63.9          71.9           71.8</span></span>
<span><span class="co">#&gt;     ci_lower_shiny ci_upper_jama ci_upper_shiny</span></span></code></pre>
<p>In some cases, we have differences in CI estimates due to rounding and/or minor differences in the way CI boundaries are computed in R versus stata. To ensure all of these differences are small enough, we allow a 1% difference in the CI boundaries for our test. I.e., |A-B|/ B &lt; 0.01</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci_diff_tolerance</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span></span>
<span> desc <span class="op">=</span> <span class="st">"shiny app matches eTable 1 of JAMA paper"</span>,</span>
<span> code <span class="op">=</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="va">test_results</span><span class="op">$</span><span class="va">estimate_jama</span>,</span>
<span>               <span class="va">test_results</span><span class="op">$</span><span class="va">estimate_shiny</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="va">test_results</span><span class="op">$</span><span class="va">ci_lower_jama</span>,</span>
<span>               <span class="va">test_results</span><span class="op">$</span><span class="va">ci_lower_shiny</span>,</span>
<span>               tolerance <span class="op">=</span> <span class="va">ci_diff_tolerance</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="va">test_results</span><span class="op">$</span><span class="va">ci_upper_jama</span>,</span>
<span>               <span class="va">test_results</span><span class="op">$</span><span class="va">ci_upper_shiny</span>,</span>
<span>               tolerance <span class="op">=</span> <span class="va">ci_diff_tolerance</span><span class="op">)</span></span>
<span></span>
<span> <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Test passed</span> 🥇</span></span></code></pre></div>
<p>success! ## Replicating Table 2</p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">Test passed</span> 😀</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Byron Jaeger, Ligong Chen, Paul Muntner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
